# CIRI-AS

CIRI-AS is a detection tool for circRNA internal components and alternative splicing events.

# Commands and arguments

## How to run CIRI-AS:

### with annotation as input:

```bash
perl CIRI_AS.pl -S in.sam -C in.ciri -O output -F ref.fa (-R ref_dir/) -A anno.gtf
```

### without annotation as input:

```bash
perl CIRI_AS.pl -S in.sam -C in.ciri -O output -F ref.fa (-R ref_dir/)
```
 
The arguments of CIRI-AS are as followings:

```text
--sam/-S			input SAM file (required; generated by BWA-MEM using PAIRED END mode)
--ciri/-C			input circRNA list (required; generated by CIRI)
--out/-O			prefix of output files (required)
--ref_dir/-R		directory of reference sequences (Please make sure FASTA files in this directory are the same ones provided to CIRI. Either this argument or --ref-file/-F is required.)
--ref_file/-F		FASTA file of all reference sequences (Please make sure this file is the same one provided to CIRI. Either this argument or --ref-dir/-R is required.)
--anno/-A			GTF formatted annotation file (optional)
--output_all/-D	if output all processing info (Choose 'yes' would require more disk space. default: no)
--log/-G			output log file name (optional)
--help/-H			show help information
```

## Preparation for using CIRI-AS:

CIRI-AS detects circRNAs internal components and alternative splicing events by processing SAM file generated by BWA-MEM as well as circRNA list generated by CIRI (please see manual of CIRI for its usage details).

CIRI-AS is applicable only to paired-end sequencing data.

## An example of running CIRI-AS:

Before we start, please make sure you have installed Perl 5.12 or higher and use Mac OS X or Linux operation system. 

Please download CIRI-AS and test_data_CIRI_AS.zip and then gunzip the four files in test_data_CIRI_AS.zip.

- `test.sam` is a SAM file of alignment records generated by BWA-MEM. The only parameter of BWA-MEM was -T 19.
- `test.ciri` is a circRNA list generated by CIRI by processing test.sam using default parameters.
- `chr1.fa` is the FASTA file of hg19 chromosome 1 downloaded from UCSC and chr1.gtf is annotation for chromosome 1 extracted from version 18 gencode gtf file.

Enter the directory and type as following in your terminal:

```bash
perl CIRI_AS.pl -S test.sam -C test.ciri -O outfile -F chr1.fa -A chr1.gtf
```

Or without the annotation gtf:

```bash
perl CIRI_AS.pl -S test.sam -C test.ciri -O outfile -F chr1.fa
```
 
CIRI-AS can finish detection within a few minutes, and you will see the following output file:

```
outfile.list
outfile_AS.list
```

Columns of output file are split by tabs ("\t" in perl).

for `outfile.list`:

Each column gives information of detected cirexons and corresponding circRNAs.

- #start_supporting_BSJ_read indicates the count of BSJ read pairs that support the start of this cirexon.
- #end_supporting_BSJ_read indicates the count of BSJ read pairs that support the end of this cirexon.
- sequencing_depth_median indicates the median of sequencing depth within the cirexon. It should be noted that the sequencing depth may also contain sequencing for linear counterparts.

for outfile_AS.list:

- Each column gives information of detected alternative splicing events within circRNAs.

# Annotation formats

When annotation file is provided, CIRI_AS can calculate insert length and provide correction value of psi for alternative spliced exons accordingly.

Like CIRI, CIRI-AS can understand GTF/GFF formatted annotation.

We recommend .gtf annotations generated by ensembl. Here is the link for their latest annotations of model organisms: ftp://ftp.ensembl.org/pub/current_gtf

Details of annotation format please see manual of CIRI.

**Please make sure you are using exactly the same version of genomic sequences and their annotations when running CIRI-AS.**